PROCEDURE tp()
  # Suppose that we have 4 nodes, tp, Alice, Bob, Charlie
  # tp is an untrusted machine
  # Alice, Bob and Charlie want to get a secret shared key

  n := nodes number
  FOR time = 1 to message length
    qubitsList := [] # container of qubits
    
    FOR i = 1 to n 
      q := new qubit
      applies H-gate on q
      appends q to qubitsList
    END FOR
    
    FOR i = 1 to n
      FOR j = i to n
        applies CPhase-gate on qubitsList[i] and qubitsList[j] # qubitsList[i] is control bit while qubitsList[j] is target
      END FOR
    END FOR
    
    FOR i = 1 to n:
      sends qubitsList[i] to node(i)
    END FOR
  END FOR
END PROCEDURE
